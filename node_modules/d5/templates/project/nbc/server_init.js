// argv
global.argv = process.argv.slice(2);

// settings: load from settings file
global.settings = require(argv[0] || './settings.json');

// underscore utils
global._ = require('underscore');

var nbc = require('nbc'),
    connect = require('connect');

var server = nbc();

server.on('error', function(message, err) {
    console.error(message);
    console.error(err);
});

server.use(connect.logger(settings.dev ? 'dev' : 'default'))
    .use(connect.query());

exports = module.exports = server;